<!DOCTYPE html> <!-- `site.alt_lang` can specify a language different from the UI --> <html lang="en" > <!-- The Head --> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"> <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" > <title>Whence cometh optics? | Thomas Bidne </title> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://realfavicongenerator.net/ --> <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/iOS Safari Web Clip/icons8-butterfly-plumpy-57.png"> <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/iOS Safari Web Clip/icons8-butterfly-plumpy-60.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/iOS Safari Web Clip/icons8-butterfly-plumpy-72.png"> <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/iOS Safari Web Clip/icons8-butterfly-plumpy-76.png"> <link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/Web/icons8-butterfly-plumpy-96.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/Web/icons8-butterfly-plumpy-32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/Web/icons8-butterfly-plumpy-16.png"> <link rel="manifest" href="/assets/img/favicons/Android Chrome/webmanifest.json"> <meta name="apple-mobile-web-app-title" content="Thomas Bidne"> <meta name="application-name" content="Thomas Bidne"> <meta name="theme-color" content="#ffffff"> <link rel="preconnect" href="https://fonts.googleapis.com" > <link rel="dns-prefetch" href="https://fonts.googleapis.com" > <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin> <link rel="preconnect" href="https://fonts.googleapis.com" > <link rel="dns-prefetch" href="https://fonts.googleapis.com" > <link rel="preconnect" href="https://cdn.jsdelivr.net" > <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" > <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"> <!-- Bootstrap --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"> <!-- Font Awesome --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"> <link rel="stylesheet" href="/assets/css/style.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <!-- Manific Popup --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <!-- JavaScript --> <script src=""></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script> <!-- Switch the mode between dark and light. --> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> </head> <body data-topbar-visible="true"> <!-- The Side Bar --> <div id="sidebar" class="d-flex flex-column align-items-end"> <div class="profile-wrapper text-center"> <div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a> </div> <div class="site-title"> <a href="/">Thomas Bidne</a> </div> <div class="site-subtitle font-italic"></div> </div><!-- .profile-wrapper --> <ul class="w-100"> <li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a> </li> <li class="nav-item"> <a href="/about/" class="nav-link"> <span>ABOUT</span> </a> </li> <li class="nav-item"> <a href="/archives/" class="nav-link"> <span>ARCHIVES</span> </a> </li> <li class="nav-item"> <a href="/categories/" class="nav-link"> <span>CATEGORIES</span> </a> </li> <li class="nav-item"> <a href="/projects/" class="nav-link"> <span>PROJECTS</span> </a> </li> <li class="nav-item"> <a href="/resume/" class="nav-link"> <span>RESUME</span> </a> </li> </ul> <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tbidne" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/tbidne" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href = 'mailto:' + ['tbidne','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> </div> <!-- .sidebar-bottom --> </div><!-- #sidebar --> <!-- The Top Bar --> <div id="topbar-wrapper"> <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Whence cometh optics?</span> </span><!-- endof #breadcrumb --> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i> <div id="topbar-title"> Post </div> <i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span> </div> </div> <div id="main-wrapper" class="d-flex justify-content-center"> <div id="main" class="container pl-xl-4 pr-xl-4"> <div class="row"> <!-- core --> <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"> <div class="post pl-1 pr-1 pl-md-2 pr-md-2"> <!-- Refactor the HTML structure. --> <!-- In order to allow a wide table to scroll horizontally, we suround the markdown table with `<div class="table-wrapper">` and `</div>` --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --> <!-- Change the icon of checkbox --> <!-- images --> <!-- Add header for code snippets --> <!-- Create heading anchors --> <!-- return --> <h1 data-toc-skip>Whence cometh optics?</h1> <div class="post-meta text-muted"> <!-- published date --> <span> Posted <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <em class="" data-ts="1681430400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 14, 2023 </em> </span> <!-- lastmod date --> <span> Updated <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <em class="" data-ts="1707969600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 15, 2024 </em> </span> <div class="d-flex justify-content-between"> <!-- author(s) --> <span> By <em> <a href="https://github.com/tbidne">Thomas Bidne</a> </em> </span> <div> <!-- page views --> <!-- read time --> <!-- Calculate the post's reading time, and display the word count in tooltip --> <!-- words per minute --> <!-- return element --> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1924 words"> <em>10 min</em> read</span> </div> </div> <!-- .d-flex --> </div> <!-- .post-meta --> <div class="post-content"> <h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p><strong>Optics</strong> are a powerful tool in certain niche areas of programming, but they can be confusing and intimidating, especially for those coming from a more traditional programming background. What are optics, why would one use them, and should you care? This post will explore each of these questions.</p> <p>This is not a comprehensive overview of optics, nor is it an explanation of how they work. Rather, it is an introduction to the topic, motivated by the problem they were designed to solve.</p> <h2 id="classic-getterssetters"><span class="mr-2">Classic Getters/Setters</span><a href="#classic-getterssetters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>The core concept involves data “getters and setters”, so let’s look at a traditional example:</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Email</span> <span class="o">{</span>
  <span class="c1">// i.e. local@domain</span>
  <span class="nc">String</span> <span class="n">local</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
  <span class="nc">String</span> <span class="n">domain</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">Email</span><span class="o">(</span><span class="nc">String</span> <span class="n">local</span><span class="o">,</span> <span class="nc">String</span> <span class="n">domain</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">local</span> <span class="o">=</span> <span class="n">local</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">domain</span> <span class="o">=</span> <span class="n">domain</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getLocal</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">local</span><span class="o">;</span> <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLocal</span><span class="o">(</span><span class="nc">String</span> <span class="n">local</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">local</span> <span class="o">=</span> <span class="n">local</span><span class="o">;</span> <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getDomain</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">domain</span><span class="o">;</span> <span class="o">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDomain</span><span class="o">(</span><span class="nc">String</span> <span class="n">domain</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">domain</span> <span class="o">=</span> <span class="n">domain</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>We have a type <code class="language-plaintext highlighter-rouge">Email</code> for representing email addresses with two fields: <code class="language-plaintext highlighter-rouge">local</code> and <code class="language-plaintext highlighter-rouge">domain</code>.</p> <p>The getters (<code class="language-plaintext highlighter-rouge">getLocal</code> and <code class="language-plaintext highlighter-rouge">getDomain</code>) are used to retrieve the field while the setters (<code class="language-plaintext highlighter-rouge">setLocal</code> and <code class="language-plaintext highlighter-rouge">setDomain</code>) are used to set the field.</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nc">Email</span> <span class="n">emailVar</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Email</span> <span class="o">(</span><span class="s">"user"</span><span class="o">,</span> <span class="s">"domain.com"</span><span class="o">);</span>

<span class="c1">// get fields</span>
<span class="nc">String</span> <span class="n">localVar</span> <span class="o">=</span> <span class="n">emailVar</span><span class="o">.</span><span class="na">getLocal</span><span class="o">();</span>
<span class="nc">String</span> <span class="n">domainVar</span> <span class="o">=</span> <span class="n">emailVar</span><span class="o">.</span><span class="na">getDomain</span><span class="o">();</span>

<span class="c1">// set fields</span>
<span class="n">emailVar</span><span class="o">.</span><span class="na">setLocal</span><span class="o">(</span><span class="s">"new_user"</span><span class="o">);</span>
<span class="n">emailVar</span><span class="o">.</span><span class="na">setDomain</span><span class="o">(</span><span class="s">"new_domain.com"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div> <p>We can view <code class="language-plaintext highlighter-rouge">getLocal</code> as a function that takes an <code class="language-plaintext highlighter-rouge">Email</code> (implicit <code class="language-plaintext highlighter-rouge">this</code>) and returns a <code class="language-plaintext highlighter-rouge">String</code>. Similarly, <code class="language-plaintext highlighter-rouge">setLocal</code> can be viewed as a function that takes a <code class="language-plaintext highlighter-rouge">String</code>, an <code class="language-plaintext highlighter-rouge">Email</code> (<code class="language-plaintext highlighter-rouge">this</code>), and returns a new <code class="language-plaintext highlighter-rouge">Email</code> (modified <code class="language-plaintext highlighter-rouge">this</code>). That is:</p> \[\begin{align*} &amp; \text{getLocal} : \text{Email} \to \text{String} \\ &amp; \text{setLocal} : \text{String} \times \text{Email} \to \text{Email} \end{align*}\] <p>Together, a getter + setter pair for a given field represents a way to “focus” on a particular field.</p> <p>An important feature of getters/setters is that they can be <em>composed</em>. That is, if we have</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>
  <span class="nc">Integer</span> <span class="n">cid</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
  <span class="nc">Email</span> <span class="n">email</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nc">Email</span> <span class="nf">getEmail</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">email</span><span class="o">;</span> <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmail</span><span class="o">(</span><span class="nc">Email</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>Then we can compose the getters/setters together:</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nc">Customer</span> <span class="n">customerVar</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Customer</span> <span class="o">(...);</span>

<span class="nc">String</span> <span class="n">domainVar</span> <span class="o">=</span> <span class="n">customerVar</span><span class="o">.</span><span class="na">getEmail</span><span class="o">().</span><span class="na">getDomain</span><span class="o">();</span>

<span class="n">customerVar</span><span class="o">.</span><span class="na">getEmail</span><span class="o">().</span><span class="na">setDomain</span><span class="o">(</span><span class="s">"new_domain.com"</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div> <p>We can therefore carry out an arbitrarily deep “get” or “set”, simply with composition.</p> <h2 id="haskell-getterssetters"><span class="mr-2">Haskell Getters/Setters</span><a href="#haskell-getterssetters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>Optics are most commonly used in Haskell, so let’s look at how we would replicate the above java. First, let’s create the equivalent types.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="kr">data</span> <span class="kt">Email</span>
  <span class="o">=</span> <span class="kt">MkEmail</span>
    <span class="p">{</span> <span class="n">local</span> <span class="o">::</span> <span class="kt">String</span><span class="p">,</span>
      <span class="n">domain</span> <span class="o">::</span> <span class="kt">String</span>
    <span class="p">}</span>

<span class="kr">data</span> <span class="kt">Customer</span>
  <span class="o">=</span> <span class="kt">MkCustomer</span>
    <span class="p">{</span> <span class="n">cid</span> <span class="o">::</span> <span class="kt">Integer</span><span class="p">,</span>
      <span class="n">email</span> <span class="o">::</span> <span class="kt">Email</span>
    <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>With this “record syntax”, haskell gives us “selectors” that are similar to java getters/setters.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kr">let</span> <span class="n">emailVar</span> <span class="o">::</span> <span class="kt">Email</span>
    <span class="n">emailVar</span> <span class="o">=</span> <span class="kt">MkEmail</span> <span class="s">"user"</span> <span class="s">"domain.com"</span>

<span class="c1">-- analogous to "email.getLocal()". Notice this is "backwards" as the 'local'</span>
<span class="c1">-- and 'domain' fields are essentially functions.</span>
<span class="c1">--</span>
<span class="c1">-- local : Email -&gt; String</span>
<span class="c1">-- domain : Email -&gt; String</span>
<span class="kr">let</span> <span class="n">localVar</span> <span class="o">::</span> <span class="kt">String</span>
    <span class="n">localVar</span> <span class="o">=</span> <span class="n">local</span> <span class="n">emailVar</span>

    <span class="n">domainVar</span> <span class="o">::</span> <span class="kt">String</span>
    <span class="n">domainVar</span> <span class="o">=</span> <span class="n">domain</span> <span class="n">emailVar</span>
</pre></td></tr></tbody></table></code></div></div> <p>Updates are more interesting. Data in haskell is <em>immutable</em> i.e. once you declare something it is constant; it cannot be changed. This is an enormously useful feature, but it poses a problem. Even if we do not need true mutability, we often want to <em>model</em> it. How do we do this in an immutable world? Well, we have to create <em>new</em> data that copies the old fields over together with the new field.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c1">-- Replicating emailVar.setDomain("new_domain.com"). Analogous to</span>
<span class="c1">-- Email newEmail = new Email(emailVar.getLocal(), "new_domain.com")</span>
<span class="kr">let</span> <span class="n">newEmail</span> <span class="o">::</span> <span class="kt">Email</span>
    <span class="n">newEmail</span> <span class="o">=</span> <span class="kt">MkEmail</span> <span class="p">(</span><span class="n">local</span> <span class="n">emailVar</span><span class="p">)</span> <span class="s">"new_domain.com"</span>
</pre></td></tr></tbody></table></code></div></div> <p>There is also a record syntax for creation, which can be clearer, if also less concise.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kr">let</span> <span class="n">newEmail</span> <span class="o">=</span>
      <span class="kt">MkEmail</span>
        <span class="p">{</span> <span class="n">local</span> <span class="o">=</span> <span class="n">local</span> <span class="n">emailVar</span><span class="p">,</span>
          <span class="n">domain</span> <span class="o">=</span> <span class="s">"new_domain.com"</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>Make no mistake, in neither case are we modifying the original <code class="language-plaintext highlighter-rouge">emailVar</code>. It is constant. We are creating a new email with the fields we want, thus <em>modeling</em> mutability, which is usually all we need.<sup id="fnref:fn1" role="doc-noteref"><a href="#fn:fn1" class="footnote" rel="footnote">1</a></sup></p> <h2 id="the-problem"><span class="mr-2">The problem</span><a href="#the-problem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>So far this works well, ergonomics notwithstanding. What about the nested case? Getting works fine:</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="c1">-- customerVar.getEmail().getDomain()</span>
<span class="kr">let</span> <span class="n">domainVar</span> <span class="o">::</span> <span class="kt">String</span>
    <span class="n">domainVar</span> <span class="o">=</span> <span class="n">domain</span> <span class="p">(</span><span class="n">email</span> <span class="n">customerVar</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div> <p>It is update that is the problem. If we want to update a field, we have to recreate the entire data structure with our new field.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="kr">let</span> <span class="c1">-- recreate emailVar with new domain</span>
    <span class="n">newEmail</span> <span class="o">=</span>
      <span class="kt">MkEmail</span>
        <span class="p">{</span> <span class="n">local</span> <span class="o">=</span> <span class="n">local</span> <span class="n">emailVar</span><span class="p">,</span>
          <span class="n">domain</span> <span class="o">=</span> <span class="s">"new_domain.com"</span>
        <span class="p">}</span>

    <span class="c1">-- recreate customerVar with new email</span>
    <span class="n">newCustomer</span> <span class="o">=</span>
      <span class="kt">MkCustomer</span>
        <span class="p">{</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">cid</span> <span class="n">customerVar</span><span class="p">,</span>
          <span class="n">email</span> <span class="o">=</span> <span class="n">newEmail</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>It is as if we had to do the following in java:</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1">// rather than customerVar.getEmail().setDomain("new_domain.com")</span>

<span class="c1">// create newEmail with the new field</span>
<span class="nc">Email</span> <span class="n">newEmail</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Email</span><span class="o">(</span><span class="n">emailVar</span><span class="o">.</span><span class="na">getLocal</span><span class="o">(),</span> <span class="s">"new_domain.com"</span><span class="o">);</span>
<span class="c1">// create a new Customer w/ our changed field</span>
<span class="nc">Customer</span> <span class="n">newCustomer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Customer</span><span class="o">(</span><span class="n">customerVar</span><span class="o">.</span><span class="na">getCid</span><span class="o">(),</span> <span class="n">newEmail</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div> <p>Obviously this does not scale at all. Something like:</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">x</span><span class="o">.</span><span class="na">getA</span><span class="o">().</span><span class="na">getB</span><span class="o">().</span><span class="na">setC</span><span class="o">(</span><span class="k">new</span> <span class="no">C</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>
</pre></td></tr></tbody></table></code></div></div> <p>would become</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="no">C</span> <span class="n">newC</span> <span class="o">=</span> <span class="k">new</span> <span class="no">C</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
<span class="no">B</span> <span class="n">newB</span> <span class="o">=</span> <span class="k">new</span> <span class="no">B</span><span class="o">(</span><span class="n">newC</span><span class="o">);</span>
<span class="no">A</span> <span class="n">newA</span> <span class="o">=</span> <span class="k">new</span> <span class="no">A</span><span class="o">(</span><span class="n">newB</span><span class="o">);</span>
<span class="no">X</span> <span class="n">newX</span> <span class="o">=</span> <span class="k">new</span> <span class="no">X</span><span class="o">(</span><span class="n">newA</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div> <p>Cthulhu help you if your data is complicated (e.g. has many fields, lists, etc.). In other words, <em>nested</em> updates and immutable data do not mix well. It is this problem that optics are designed to solve.</p> <h2 id="lenses"><span class="mr-2">Lenses</span><a href="#lenses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>There are many types of optics, but for our purposes we will only consider <strong>lenses</strong>, arguably the easiest to motivate. Lenses take the idea of a “getter/setter pair” and turn it into actual data. Without getting into the implementation, a lens in haskell looks something like:</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">emailDomainLens</span> <span class="o">::</span> <span class="kt">Lens</span> <span class="kt">Email</span> <span class="kt">String</span>
</pre></td></tr></tbody></table></code></div></div> <p>That is, <code class="language-plaintext highlighter-rouge">emailDomainLens</code> represents the concept of “getting and setting the String field domain” on the type <code class="language-plaintext highlighter-rouge">Email</code>. This gives us an alternative to the selectors used before:</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c1">-- Like email.getDomain(). 'view' is a function that takes in a lens, data, and</span>
<span class="c1">-- "activates" the getter portion of the lens to get the desired field. Morally,</span>
<span class="c1">--</span>
<span class="c1">-- view :: Lens s a -&gt; s -&gt; a</span>
<span class="kr">let</span> <span class="n">domainVar</span> <span class="o">::</span> <span class="kt">String</span>
    <span class="c1">-- Instead of: domainVar = domain emailVar</span>
    <span class="n">domainVar</span> <span class="o">=</span> <span class="n">view</span> <span class="n">emailDomainLens</span> <span class="n">emailVar</span>

<span class="c1">-- Like email.setDomain("new_domain.com"). 'set' is a function that takes in a lens, the</span>
<span class="c1">-- new value, data, and "activates" the setter portion of the lens to set the</span>
<span class="c1">-- desired field. Morally,</span>
<span class="c1">--</span>
<span class="c1">-- set :: Lens s a -&gt; a -&gt; s -&gt; s</span>
<span class="kr">let</span> <span class="n">newEmail</span> <span class="o">::</span> <span class="kt">Email</span>
    <span class="c1">-- Instead of: newEmail = MkEmail (local emailVar) "new_domain.com"</span>
    <span class="n">newEmail</span> <span class="o">=</span> <span class="n">set</span> <span class="n">emailDomainLens</span> <span class="s">"new_domain.com"</span> <span class="n">emailVar</span>
</pre></td></tr></tbody></table></code></div></div> <p>This is why lenses are referred to as “first class getters/setters”. Rather than having some syntax built into the language (e.g. java methods), lenses are just like anything else in haskell: a type we can define ourselves that implements the “getter/setter” concept with respect to some data.</p> <p>At this point you would be forgiven for wondering what the big deal is. This seems like a lot of work just to come up with a worse syntax. Why go through all this trouble? The crucial advantage that lenses have over traditional haskell updates is that they can be <em>composed</em>. Remember the previous example?</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="kr">let</span> <span class="n">newEmail</span> <span class="o">=</span>
      <span class="kt">MkEmail</span>
        <span class="p">{</span> <span class="n">local</span> <span class="o">=</span> <span class="n">local</span> <span class="n">emailVar</span><span class="p">,</span>
          <span class="n">domain</span> <span class="o">=</span> <span class="s">"new_domain.com"</span>
        <span class="p">}</span>
    <span class="n">newCustomer</span> <span class="o">=</span>
      <span class="kt">MkCustomer</span>
        <span class="p">{</span> <span class="n">cid</span> <span class="o">=</span> <span class="n">cid</span> <span class="n">customerVar</span><span class="p">,</span>
          <span class="n">email</span> <span class="o">=</span> <span class="n">newEmail</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div> <p>The fundamental problem is that while we can fairly easily update <code class="language-plaintext highlighter-rouge">customer.email</code> and <code class="language-plaintext highlighter-rouge">email.domain</code>, we cannot compose these to easily update <code class="language-plaintext highlighter-rouge">customer.email.domain</code>. Lenses do not have this problem. If we have a <code class="language-plaintext highlighter-rouge">Lens a b</code> and a <code class="language-plaintext highlighter-rouge">Lens b c</code>, then we can easily form a <code class="language-plaintext highlighter-rouge">Lens a c</code>.</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c1">-- customerEmailLens is a lens for the Email field on the Customer type</span>
<span class="n">customerEmailLens</span> <span class="o">::</span> <span class="kt">Lens</span> <span class="kt">Customer</span> <span class="kt">Email</span>

<span class="kr">let</span> <span class="c1">-- We can freely compose (combine) lenses together e.g.</span>
    <span class="c1">--</span>
    <span class="c1">--   innerLens :: Lens s a</span>
    <span class="c1">--   outerLens :: Lens t s</span>
    <span class="c1">--</span>
    <span class="c1">--   (outerLens . innerLens) :: Lens t a</span>
    <span class="n">customerDomainLens</span> <span class="o">::</span> <span class="kt">Lens</span> <span class="kt">Customer</span> <span class="kt">String</span>
    <span class="n">customerDomainLens</span> <span class="o">=</span> <span class="n">customerEmailLens</span> <span class="o">.</span> <span class="n">emailDomainLens</span>

    <span class="c1">-- we now have our customerVar.getEmail().setDomain("new_domain.com")!</span>
    <span class="n">newCustomer</span> <span class="o">::</span> <span class="kt">Customer</span>
    <span class="n">newCustomer</span> <span class="o">=</span> <span class="n">set</span> <span class="n">customerDomainLens</span> <span class="s">"new_domain.com"</span> <span class="n">customerVar</span>
</pre></td></tr></tbody></table></code></div></div> <p>The advantage is easily seen with the “extreme” example:</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">x</span><span class="o">.</span><span class="na">getA</span><span class="o">().</span><span class="na">getB</span><span class="o">().</span><span class="na">setC</span><span class="o">(</span><span class="k">new</span> <span class="no">C</span><span class="o">(</span><span class="mi">5</span><span class="o">));</span>
</pre></td></tr></tbody></table></code></div></div> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1">-- composition FTW</span>
<span class="kr">let</span> <span class="n">newX</span> <span class="o">=</span> <span class="n">set</span> <span class="p">(</span><span class="n">aLens</span> <span class="o">.</span> <span class="n">bLens</span> <span class="o">.</span> <span class="n">cLens</span><span class="p">)</span> <span class="mi">5</span> <span class="n">x</span>
</pre></td></tr></tbody></table></code></div></div> <p>Thus we arrive at the primary motivation. Even if we do not need <strong>true</strong> mutability, we often need to model it. This can be quite difficult with immutable data. Unless our language provides special syntax for it, we have to manually recreate the data. Lenses exist to recover the ergonomics of mutability (i.e. nested getters/setters) in an immutable world.</p> <h2 id="should-you-care"><span class="mr-2">Should you care?</span><a href="#should-you-care" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>For working with immutable data, it is certainly worth being aware of lenses (and other optics). They are never necessary, but they can make life much easier.</p> <p>However, this is not the world inhabited by most programming. For better or worse, most programming languages fully embrace true mutability, thus we immediately have access to nested getters/setters. In this world, should you care about lenses?</p> <p>Probably not, as a major motivator is gone. Java doesn’t have this problem as all data is mutable, thus there is little need to torture yourself trying to implement lenses in java (of course, <a href="https://github.com/Mojang/DataFixerUpper/blob/f6f24872c23a3be12c33fb6fc9e5372fad5f9cee/src/main/java/com/mojang/datafixers/optics/Lens.java">masochism exists</a>).<sup id="fnref:fn2" role="doc-noteref"><a href="#fn:fn2" class="footnote" rel="footnote">2</a></sup></p> <p>To put it more directly, you do not typically want to use lenses for their own sake, as an alternative to normal getters/setters. You use them because you want to use immutable data, and lenses make immutability less painful.</p> <h2 id="addendum"><span class="mr-2">Addendum</span><a href="#addendum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>While composition is the primary motivation for lenses, it isn’t the only advantage.</p> <p>In java you are mildly screwed if you want to update a field, rather than just set it.</p> <div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="no">C</span> <span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="na">getA</span><span class="o">().</span><span class="na">getB</span><span class="o">().</span><span class="na">getC</span><span class="o">();</span>
<span class="n">c</span><span class="o">.</span><span class="na">setVal</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="na">getVal</span><span class="o">()</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span> <span class="c1">// can't do this inline</span>
<span class="n">x</span><span class="o">.</span><span class="na">getA</span><span class="o">().</span><span class="na">getB</span><span class="o">().</span><span class="na">setC</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
</pre></td></tr></tbody></table></code></div></div> <p>Lenses handle this just fine:</p> <div class="language-haskell highlighter-rouge"><div class="code-header"> <span data-label-text="Haskell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="c1">-- 'over' takes in a lens, a _function_, and the data to modify. Morally,</span>
<span class="c1">--</span>
<span class="c1">--- over :: Lens s a -&gt; (a -&gt; a) -&gt; s -&gt; s</span>
<span class="kr">let</span> <span class="n">newX</span> <span class="o">=</span> <span class="n">over</span> <span class="p">(</span><span class="n">aLens</span> <span class="o">.</span> <span class="n">bLens</span> <span class="o">.</span> <span class="n">cLens</span><span class="p">)</span> <span class="p">(</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="n">x</span>
</pre></td></tr></tbody></table></code></div></div> <p>When people say lenses are more powerful than traditional getters/setters, this is what they mean. Because lenses are just ordinary data, we can manipulate them like anything else and define custom behavior (in this case <code class="language-plaintext highlighter-rouge">over</code> for <em>modifying</em> a field, rather than mere <code class="language-plaintext highlighter-rouge">set</code>).</p> <p>Lenses are just one example of an <strong>optic</strong>. For instance, <strong>prisms</strong> are another type of optic that adapts the lens concept to sum types.</p> <hr /> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:fn1" role="doc-endnote"> <p>Technically haskell has “update syntax” for this that looks like <code class="language-plaintext highlighter-rouge">newEmail = emailVar { domain = "new_domain.com" }</code>. But we cannot “nest” updates (i.e. it does not compose), thus it is not a general solution to the described problem. <a href="#fnref:fn1" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> <li id="fn:fn2" role="doc-endnote"> <p>Not to mention, it is not possible to implement lenses (or other optics) in most languages as the concept requires Higher-Kinded Types (think “nested generics” e.g. <code class="language-plaintext highlighter-rouge">F&lt;A&gt;</code>), which very few languages support. It is only achievable in Java through an impressive yet hideous <a href="https://github.com/highj/highj">hack</a>. <a href="#fnref:fn2" class="reversefootnote" role="doc-backlink">&#8617;</a></p> </li> </ol> </div> </div> <div class="post-tail-wrapper text-muted"> <!-- categories --> <div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/programming/'>Programming</a> </div> <!-- tags --> <div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/functional-programming/" class="post-tag no-text-decoration" >functional programming</a> <a href="/tags/haskell/" class="post-tag no-text-decoration" >haskell</a> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> </div> <div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"> <div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. </div> <!-- Post sharing snippet --> <div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Whence%20cometh%20optics?%20-%20Thomas%20Bidne&url=%2Fposts%2Foptics%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Whence%20cometh%20optics?%20-%20Thomas%20Bidne&u=%2Fposts%2Foptics%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Foptics%2F&text=Whence%20cometh%20optics?%20-%20Thomas%20Bidne" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fposts%2Foptics%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span> </div> </div><!-- .post-tail-bottom --> </div><!-- div.post-tail-wrapper --> </div> </div> <!-- #core-wrapper --> <!-- panel --> <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"> <div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <div class="panel-heading pl-3 pt-2 mb-2">Contents</div> <nav id="toc"></nav> </div> <!-- toc.js will be loaded at medium priority --> <script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script> </div> </div> <!-- tail --> <div class="row"> <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. --> <!-- The total size of related posts --> <!-- An random integer that bigger than 0 --> <!-- Equals to TAG_SCORE / {max_categories_hierarchy} --> <!-- Fill with the other newlest posts --> <div id="related-posts" class="mb-2 mb-sm-4"> <h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3> <div class="card-deck mb-4"> <div class="card"> <a href="/posts/haskell-records/"> <div class="card-body"> <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <em class="small" data-ts="1709150400" data-df="ll" > Feb 29, 2024 </em> <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Haskell records</h3> <div class="text-muted small"> <p> Introduction Haskell records appear simple, but this simplicity belies some significant drawbacks. While there are a plethora of libraries and language extensions that improve ergonomics, the trad... </p> </div> </div> </a> </div> <div class="card"> <a href="/posts/monads-monoids/"> <div class="card-body"> <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <em class="small" data-ts="1593388800" data-df="ll" > Jun 29, 2020 </em> <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Monads are just monoids in the category of endofunctors, what's the problem?</h3> <div class="text-muted small"> <p> Introduction The title is from James Iry’s classic A Brief, Incomplete, and Mostly Wrong History of Programming Languages, an hilarious rundown of various programming languages. The statement was ... </p> </div> </div> </a> </div> </div> <!-- .card-deck --> </div> <!-- #related-posts --> <!-- Navigation buttons at the bottom of the post. --> <div class="post-navigation d-flex justify-content-between"> <a href="/posts/monads-monoids/" class="btn btn-outline-primary" prompt="Older"> <p>Monads are just monoids in the category of endofunctors, what's the problem?</p> </a> <a href="/posts/haskell-records/" class="btn btn-outline-primary" prompt="Newer"> <p>Haskell records</p> </a> </div> </div> </div> </div> <!-- The Search results --> <div id="search-result-wrapper" class="d-flex justify-content-center unloaded"> <div class="col-12 col-sm-11 post-content"> <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div> </div> </div> </div> <!-- #main-wrapper --> <!-- The Footer --> <footer> <div class="container pl-lg-4 pr-lg-4"> <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"> <div class="footer-left"> <p class="mb-0"> © 2024 <a href="https://github.com/tbidne">Thomas Bidne</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span> </p> </div> <div class="footer-right"> <p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>. </p> <a target="_blank" href="https://icons8.com/icon/jt6jc0TVClpt/butterfly">Butterfly</a> icon by <a target="_blank" href="https://icons8.com">Icons8</a> </div> </div> </div> </footer> <div id="mask"></div> <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader See: <https://github.com/christian-fei/Simple-Jekyll-Search> --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a> <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags} </div> <p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <!-- JS selector for site. --> <!-- layout specified --> <!-- image lazy-loading & popup & clipboard --> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <!-- commons --> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> </body> </html>
